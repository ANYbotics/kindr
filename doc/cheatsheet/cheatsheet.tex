% Copyright (c) 2013, Christian Gehring, Hannes Sommer, Paul Furgale, Remo Diethelm
% All rights reserved.
% 
% Redistribution and use in source and binary forms, with or without
% modification, are permitted provided that the following conditions are met:
%     * Redistributions of source code must retain the above copyright
%       notice, this list of conditions and the following disclaimer.
%     * Redistributions in binary form must reproduce the above copyright
%       notice, this list of conditions and the following disclaimer in the
%       documentation and/or other materials provided with the distribution.
%     * Neither the name of the <organization> nor the
%       names of its contributors may be used to endorse or promote products
%       derived from this software without specific prior written permission.
% 
% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
% ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
% WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
% DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
% DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
% (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
% LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
% ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
% (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
% SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

\documentclass[10pt,landscape,a4paper]{article}
\usepackage{nonfloat}
\usepackage{multicol}
\usepackage[font=scriptsize]{caption}
\usepackage{calc}
\usepackage{ifthen}
\usepackage[landscape]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{multirow}
 \usepackage[T1]{fontenc}
% \usepackage{bbold}
    \usepackage{dsfont}
%\usepackage{esvect}
\usepackage{graphics}
   \usepackage[pdftex]{graphicx}
\usepackage{epstopdf}
 \usepackage{ifpdf}
\usepackage{sectsty}
\paragraphfont{\small}

% To make this come out properly in landscape mode, do one of the following
% 1.
%  pdflatex latexsheet.tex
%
% 2.
%  latex latexsheet.tex
%  dvips -P pdf  -t landscape latexsheet.dvi
%  ps2pdf latexsheet.ps


% If you're reading this, be prepared for confusion.  Making this was
% a learning experience for me, and it shows.  Much of the placement
% was hacked in; if you make it better, let me know...


% 2008-04
% Changed page margin code to use the geometry package. Also added code for
% conditional page margins, depending on paper size. Thanks to Uwe Ziegenhagen
% for the suggestions.

% 2006-08
% Made changes based on suggestions from Gene Cooperman. <gene at ccs.neu.edu>


% To Do:
% \listoffigures \listoftables
% \setcounter{secnumdepth}{0}


% This sets page margins to .5 inch if using letter paper, and to 1cm
% if using A4 paper. (This probably isn't strictly necessary.)
% If using another size paper, use default 1cm margins.
\ifthenelse{\lengthtest { \paperwidth = 11in}}
	{ \geometry{top=.5in,left=.5in,right=.5in,bottom=.5in} }
	{\ifthenelse{ \lengthtest{ \paperwidth = 297mm}}
		{\geometry{top=1cm,left=1cm,right=1cm,bottom=1cm} }
		{\geometry{top=1cm,left=1cm,right=1cm,bottom=1cm} }
	}

% Turn off header and footer
\pagestyle{empty}
 

% Redefine section commands to use less space
\makeatletter
\renewcommand{\section}{\@startsection{section}{1}{0mm}%
                                {-1ex plus -.5ex minus -.2ex}%
                                {0.5ex plus .2ex}%x
                                {\normalfont\large\bfseries}}
\renewcommand{\subsection}{\@startsection{subsection}{2}{0mm}%
                                {-1explus -.5ex minus -.2ex}%
                                {0.5ex plus .2ex}%
                                {\normalfont\normalsize\bfseries}}
\renewcommand{\subsubsection}{\@startsection{subsubsection}{3}{0mm}%
                                {-1ex plus -.5ex minus -.2ex}%
                                {1ex plus .2ex}%
                                {\normalfont\small\bfseries}}
\makeatother

% Define BibTeX command
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

% Don't print section numbers
\setcounter{secnumdepth}{0}


\setlength{\parindent}{0pt}
\setlength{\parskip}{0pt plus 0.5ex}


 \input{styles/def}
% -----------------------------------------------------------------------
\DeclareGraphicsExtensions{.pdf,.eps}
 \DeclareMathOperator{\tr}{tr}

% identity matrix
\newcommand\identity{\mathds{1}}
\newcommand\zero{\mathbf{0}}
\newcommand\norm[1]{\lVert #1 \rVert}
\newcommand\transpose{\mathsf{T}}

\newcommand\imquatvec[1]{\overrightarrow{\mathbf{#1}}}

\newcommand\pos[3]{{}_#1\vr_{#2\!#3}}
\newcommand\postranspose[3]{{}_#1\vr_{#2\!#3}^\transpose}
\newcommand\rotmat[2]{\vR_{#1\!#2}}
\newcommand\drotmat[2]{\dot{\vR}_{#1\!#2}}
\newcommand\comat[2]{\vC_{#1\!#2}}
\newcommand\dcomat[2]{\dot{\vC}_{#1\!#2}}
\newcommand\quat[2]{\vp_{#1\!#2}}
\newcommand\Quat[2]{P_{#1\!#2}}
\newcommand\angleaxis[2]{(\theta,\vn)_{#1\!#2}}
\newcommand\rotvec[2]{\vvph_{#1\!#2}}
\newcommand\linvel[2]{{}_#1\vv_{#2}}
\newcommand\rotvel[3]{{}_#1\vom_{#2\!#3}}
\newcommand\rotvelhat[3]{{}_#1\hat{\vom}_{#2\!#3}}

\newcommand\myfigure[1]{%
\medskip\noindent\begin{minipage}{\columnwidth}
\centering%
#1%
%figure,caption, and label go here
\end{minipage}\medskip}

\begin{document}

\raggedright
\footnotesize
\begin{multicols}{2}


% multicol parameters
% These lengths are set only within the two main columns
%\setlength{\columnseprule}{0.25pt}
\setlength{\premulticols}{1pt}
\setlength{\postmulticols}{1pt}
\setlength{\multicolsep}{1pt}
\setlength{\columnsep}{2pt}

\begin{center}
     \Large{\textbf{Robotics Cheat Sheet}} \\
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  BEGIN CONTENT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Nomenclature }
\begin{tabular}{|l|l@{}|l|}
\hline
(Hyper-)complex number & $Q$ & normal capital letter  \\ \hline
Column vector & $\va$ & bold small letter  \\ \hline
Matrix & $\vM$ & bold capital letter  \\ \hline
Identity matrix & $\identity_{n\times m}$ & ${n \times m}$-matrix  \\  \hline
Coordinate system (CS) & ${\ve_x^B,\ve_y^B,\ve_z^B}$ & Cartesian right-hand system $B$ with basis (unit) vectors $\ve$  \\ \hline
Machine precision & $\epsilon$ & \\ \hline
%Translational velocity & $\linvel{I}{P} \in \mathbb{R}^3 $  & translational velocity of point $P$ expressed in CS $I$ \\ \hline
%Angular velocity & $\rotvel{I}{I}{B} \in \mathbb{R}^3 $ & ang. velocity of CS $B$ w.r.t. to CS $B$ expressed in CS $I$ \\ \hline
%Ang. vel. of rigid body & ${}_B\vOm = \rotvel{B}{I}{B}$ & with body-fixed CS $B$ and inertial CS $I$ \\ \hline
%Ang. acc. of rigid body & ${}_B\vPs$ \\ \hline

% Generalized coordinates & $\vq \in \mathbb{Q} \subset \mathbb{R}^{n_q}$ & set of coordinates to describe a multi-rigid-body system\\ \hline
% Generalized velocities & $\vu \in \mathbb{U} \subset \mathbb{R}^{n_u}$ & gen. velocities of multi-rigid-body system, where $\vu = \vF\dot{\vq}$\\ \hline
\end{tabular}
\section{Operators}
\begin{tabular}{|l|l|}
\hline
Cross product & $\va \times \vb = \begin{bmatrix} a_1 \\ a_2 \\ a_3\end{bmatrix} \times \begin{bmatrix} b_1 \\ b_2 \\ b_3\end{bmatrix} \Leftrightarrow (\va)^\wedge \vb = \hat{\va}\vb = \begin{bmatrix} 0 & -a_3 & a_2 \\ a_3 & 0 & -a_1 \\ -a_2 & a_1 & 0 \end{bmatrix} \begin{bmatrix} b_1 \\ b_2 \\ b_3\end{bmatrix}$ \\ \hline
Euclidean norm & $\norm{\va} = \sqrt{\va^T\va} = \sqrt{a_1^2 + \ldots + a_n^2}$ \\ \hline
Quaternion multiplicator & $ \vq\otimes\vp  \Leftrightarrow Q\cdot P $ \\ \hline
\end{tabular}

\section{Pose (Position \& Orientation)}
\subsection{Position}
\begin{tabular}{|l|l|l|}
 \hline
Position vector & $\pos{I}{O}{P} \in \mathbb{R}^3 $ & vector from point $O$ to point $P$ expr. in CS $I$ \\ \hline 
Homogeneous pos. vector & $_I\bar{\vr}_{O\!P} = \begin{bmatrix}\postranspose{I}{O}{P} & 1 \end{bmatrix}^\transpose$ & vector from point $O$ to point $P$ expr. in CS $I$ \\ \hline
\end{tabular}


\subsection{Orientation}
\begin{tabular}{|l|l@{}|l@{}|}
\hline
Rotation matrix & $\rotmat{B}{A} \in \mathrm{SO}(3)$ & Rotates the coord. of the basis vectors $(_A\ve_x^A, _A\ve_y^A, _A\ve_z^A)$ \\
 & & of frame $A$ expressed in $A$  into the coordinates of the  \\
& & basis vectors $(_A\ve_x^B, _A\ve_y^B, _A\ve_z^B)$ of $B$ expressed in $A$. \\ 
 &  &  The rotation is active (alibi). \\
& & $_A\rotmat{B}{A} = \begin{bmatrix}_A\ve_x^B & _A\ve_y^B & _A\ve_z^B\end{bmatrix}$ \\ \hline
Direct Cosine& $\comat{B}{A} \in \mathrm{SO}(3)$ & The coordinate tranformation matrix, which transforms \\  
 matrix & $ \pos{B}{O}{P} = \comat{B}{A} \pos{A}{O}{P}$ & vectors from frame $A$ to frame $B$. \\
& $\comat{B}{A} = \rotmat{B}{A}^\transpose$ & The rotation is passive (alias). \\  \hline 
 Rotation  & $\quat{B}{A}$ & The rotation is active (alibi). \\
Quaternion &   $\quat{B}{A} \Leftrightarrow \rotmat{B}{A} $ &  \\ \hline
Rotation & $\angleaxis{B}{A}$ &   Rotation with unit rotation axis $\vn$ and angle $\theta \in [-\pi, \pi)$. \\
Angle-axis & $\angleaxis{B}{A} \Leftrightarrow \rotmat{B}{A}$  & The rotation is active (alibi). \\ \hline
Rotation vector & $ \rotvec{B}{A} $  &  Rotation with rotation axis $\vn = \frac{\vvph}{\norm{\vvph}}$ and angle $\theta = \norm{\vvph}$. \\ 
 & $\rotvec{B}{A} \Leftrightarrow \rotmat{B}{A} $ &  The rotation is active (alibi). \\ \hline
Euler Angles ZYX &  $(\psi, \theta, \phi)_{B\!A}$  & Tait-Bryan angles (Flight conv.): $z-y'-x''$, i.e.\   \\
Euler Angles YPR & & yaw-pitch-roll. Singularities are at $\theta=\pm\frac{\pi}{2}$. \\
 &  & $\psi\in[-\pi,\pi), \theta\in[-\frac{\pi}{2},\frac{\pi}{2}), \phi\in[-\pi,\pi)$  \\  \hline
Euler Angles XYZ &  $(\alpha, \beta, \gamma)_{B\!A}$ & Cardan angles (Glocker conv.): $x-y'-z''$, i.e.\ \\
Euler Angles RPY & & roll-pitch-yaw. Singularities are at $\beta=\pm\frac{\pi}{2}$.  \\
 &  & $\alpha\in[-\pi,\pi), \beta\in[-\frac{\pi}{2},\frac{\pi}{2}), \gamma\in[-\pi,\pi)$  \\  \hline
\end{tabular} % \multirow{2}{*}{}

\subsubsection{Rotation Quaternion}
A rotation quaternion is defined as a Hamiltonian unit quaternion: \\
$\boxed{\begin{aligned}P &= p_0 + p_1 i + p_2 j + p_3 k \in \mathbb{H}, \quad p_i \in \mathbb{R} \\
i^2 &= j^2=k^2 = ijk = -1, \quad \norm{P}= \sqrt{p_0^2 + p_1^2 + p_2^2 + p_3^2} = 1 \\
\end{aligned}}$   \\
Note that $\Quat{B}{A}$ and $-\Quat{B}{A}$ represent the same rotation, but not the same unit quaternion. \\
Rot. quaternion as tuple: $P = (p_0, p_1, p_2, p_3) = (p_0, \imquatvec{p})$ with $\imquatvec{p} := (p_1, p_2, p_3)^\transpose $ \\
Rot. quaternion as vector: $\vp = \begin{bmatrix} p_0 & p_1 & p_2 & p_3 \end{bmatrix}^\transpose $\\
% Imaginary part: $\overrightarrow{\vp} := (p_1, p_2, p_3)^\transpose$
% Real part: $p_0 = \vP_\mathnormal{Re}\vp $ \\

% Imaginary part: $\vp_{1:3} := \vP_\mathnormal{Im}\vp = \begin{bmatrix} p_1 & p_2 & p_3 \end{bmatrix}^\transpose $\\

Conjugate: $P^\ast = (p_0, -\imquatvec{p})$ \\
Inverse: $P^{-1} = P^\ast = (p_0, -\imquatvec{p})$ \\
Quaternion multiplication: $\begin{aligned}Q \cdot P &= (q_0, \imquatvec{q})\cdot(p_0, \imquatvec{p}) = (q_0 p_0 - \imquatvec{q}^\transpose \imquatvec{p}, q_{0} \imquatvec{p} + p_0 \imquatvec{q} + \imquatvec{q} \times \imquatvec{p}) \quad \Leftrightarrow \\
	   \vq^\otimes \vp &= \vQ(\vq)\vp = \begin{pmatrix}q_0 & -\imquatvec{q}^\transpose \\  \imquatvec{q} & q_0\identity_{3 \times 3}+\hat{\imquatvec{p}} \\ \end{pmatrix} \begin{pmatrix} p_0 \\ p_1 \\ p_2 \\ p_3 \end{pmatrix} 
	  = \begin{pmatrix} 
 q_0 & -q_1 & -q_2 & -q_3 \\
 q_1 &  q_0 & -q_3 &  q_2 \\
 q_2 &  q_3 &  q_0 & -q_1 \\
 q_3 & -q_2 &  q_1 &  q_0 \\ \end{pmatrix}\begin{pmatrix} p_0 \\ p_1 \\ p_2 \\ p_3 \end{pmatrix} = \vQ(\vp)^\transpose \vq \\
\end{aligned}$ \\





%$\begin{aligned}{}_B\vr_{OP} &= {}_I\vr_{OP} + 2a_0\tilde{\va} {}_I\vr_{OP} + 2 \tilde{\va}^2 {}_I\vr_{OP}, \quad  \text{(Eigen)} \\
% &= \vp_{BI} (0, {}_I\vr_{OP}^T)^T \vp_{BI}^{-1} = (a_0, \va^T)^T (0, {}_I\vr_{OP}^T)^T (a_0, -\va^T)^T \end{aligned}$



\subsubsection{Rotation Quaternion $\Leftrightarrow$ Rotation Angle-Axis}

\begin{tabular}{@{}lll@{}} 
$ \quat{B}{I} = \begin{bmatrix} \cos{\frac{\theta}{2}} \\ \vn \sin{\frac{\theta}{2}} \end{bmatrix}$ & $\Leftrightarrow$ & $
(\theta, \vn)_{B\!I} = \left\{
  \begin{array}{l l}
    (2\arccos{(a_0)}, \frac{\imquatvec{p}}{\norm{\imquatvec{p}}}) & \quad \text{if $\lVert \imquatvec{p} \rVert^2 \geq \epsilon^2$}\\
    (0, \begin{bmatrix}1 & 0 & 0\end{bmatrix}^\transpose)  & \quad \text{otherwise}
  \end{array} \right. $ \\
\end{tabular}
\subsubsection{Rotation Quaternion $\Leftrightarrow$ Direction Cosine Matrix }
$\begin{aligned}\comat{A}{B} &= \rotmat{A}{B}^\transpose(\quat{A}{B}) =  \identity_{3\times 3} + 2 p_0\hat{\imquatvec{p}} + 2 \hat{\imquatvec{p}}^2    \\
&= \begin{bmatrix}
 p_0^2 + p_1^2 - p_2^2 - p_3^2 &         2p_1p_2 - 2p_0p_3 &         2p_0p_2 + 2p_1p_3 \\
         2p_0p_3 + 2p_1p_2 & p_0^2 - p_1^2 + p_2^2 - p_3^2 &         2p_2p_3 - 2p_0p_1 \\
         2p_1p_3 - 2p_0p_2 &         2p_0p_1 + 2p_2p_3 & p_0^2 - p_1^2 - p_2^2 + p_3^2 \\ \end{bmatrix} \\
\end{aligned}$
%= \begin{pmatrix} 1 - 2 a_2^2 - 2 a_3^2  &     2 a_1 a_2 - 2 a_0 a_3 &     2 a_0 a_2 + 2 a_1 a_3 \\
     %2 a_0 a_3 + 2 a_1 a_2 & 1 - 2 a_1^2 - 2 a_3^2 &     2 a_2 a_3 - 2 a_0 a_1 \\
     %2 a_1 a_3 - 2 a_0 a_2 &     2 a_0 a_1 + 2 a_2 a_3 & 1 - 2 a_1^2 - 2 a_2^2  \\
%\end{pmatrix}

$\begin{aligned}\comat{B}{A} &= \rotmat{B}{A}^\transpose =  \rotmat{A}{B}(\quat{A}{B}) = \identity_{3 \times 3} - 2 p_0\hat{\imquatvec{p}} + 2 \hat{\imquatvec{p}}^2 \\
&= \begin{bmatrix}  p_0^2 + p_1^2 - p_2^2 - p_3^2 &         2p_0p_3 + 2p_1p_2 &         2p_1p_3 - 2p_0p_2 \\
         2p_1p_2 - 2p_0p_3 & p_0^2 - p_1^2 + p_2^2 - p_3^2 &         2p_0p_1 + 2p_2p_3 \\
         2p_0p_2 + 2p_1p_3 &         2p_2p_3 - 2p_0p_1 & p_0^2 - p_1^2 - p_2^2 + p_3^2 \\ \end{bmatrix}  \\  
\end{aligned}$ \\

$\vp_{BA} = \vp_{BA}(\comat{A}{B}) = \begin{bmatrix} \frac{1}{2} \sqrt{1 + \tr(\vC)} \\ \frac{C_{32} - C_{23}}{4 p_0} \\ \frac{C_{13} - C_{31}}{4 p_0} \\ \frac{C_{21} - C_{12}}{4 p_0} \end{bmatrix} \quad \text{if $\tr{(\vC	)} > 0 $}$ ($\comat{A}{B} \rightarrow \quat{B}{A}$ is not unique)

\subsubsection{Euler Angles ZYX $\Leftrightarrow$ Direction Cosine Matrix}
\myfigure{\includegraphics[width=1\columnwidth]{coordinate_systems/coordinate_system_ypr-crop.pdf}\vspace{-3mm}
\figcaption{Rotation from $I$-frame to $B$-frame: ($z-y'-x''$) -- (yaw-pitch-roll) -- ($\psi-\theta-\phi$) -- ($50^\circ-25^\circ-30^\circ)$}\label{fig:yaw-pitch-roll}}
\subsubsection{Euler Angles XYZ $\Leftrightarrow$ Direction Cosine Matrix}
\myfigure{\includegraphics[width=1\columnwidth]{coordinate_systems/coordinate_system_rpy-crop.pdf}\vspace{-3mm}
\figcaption{Rotation from $I$-frame to $B$-frame: ($x-y'-z''$) -- (roll-pitch-yaw) -- ($\alpha-\beta-\gamma$) -- ($50^\circ-25^\circ-30^\circ)$}\label{fig:roll-pitch-yaw}}


% \subsection{Eigen Library}
% \begin{tabular}{@{}ll@{}} 
%  \verb!Vector3d ypr_BI = Vectord(psi,theta, phi);!  \\
%  \verb!aa_BI = AngleAxis(ypr_BI(0), Vector3d::UnitZ())*! \\
%  \verb!        AngleAxis(ypr_BI(1), Vector3d::UnitY())*! \\
%  \verb!        AngleAxis(ypr_BI(2), Vector3d::UnitX());! \\ 
%  \verb!Quaterniond p_BI = Quaterniond(aa_BI);! \\
%  \verb!Matrix3d A_IB = p_BI.toRotationMatrix();! \\
%  \verb!Vector3d I_r_OP = A_IB*B_r_OP! & \\
% \end{tabular}



% \subsubsection{Successive Composition of Rotations}
% $\vp_{IB} = \vp_{ID} \vp_{DC} \vp_{CB} \Leftrightarrow \vA_{BI} = \vA_{BC}\vA_{CD}\vA_{DI}$
% 
% \subsubsection{Transformation of a Vector}
% 
% ${}_{B}\vr_{OP} = \vA_{BI} {}_{I}\vr_{OP}$
% 
% $(0, {}_B\vr_{OP}) = \vp_{IB} (0, {}_I\vr_{OP}) \vp_{IB}^{-1}$ ????

\subsection{Pose}
\begin{tabular}{|l|l|l|}
\hline
Homogeneous Transformation Matrix & $\vT_{A\!B}$ &   \\ \hline
\end{tabular}

\subsubsection{Homogeneous Transformation Matrix}
 $\vT_{A\!B} = \begin{bmatrix}
              \comat{A}{B} & \pos{A}{A}{B} \\
	      \zero^\transpose & 1 \\
             \end{bmatrix}$

\section{Twist (Translational \& Rotational Velocity)}
\subsection{Translational Velocity}
\begin{tabular}{@{}ll@{}}
${}_B\vv_P = {}_B\vv_A  + {}_B\dot{\vr}_{AP} + \rotvel{B}{I}{B} \times \pos{B}{A}{P}$ & velocity of point $P$ expr. in CS $B$  w.r.t. to the inertial system $I$\\
${}_B\vv_Q = {}_B\vv_{P} + {}_B\vOm \times \pos{B}{P}{Q}$ &  velocity of point $Q$ on rigid body $B$ from point $P$ on same body\\
\end{tabular}

\subsection{Angular Velocity}
\begin{tabular}{@{}ll@{}}
${}_B\vOm = \rotvel{B}{I}{B}$ & ang. vel. of rigid body with body-fixed CS $B$ w.r.t. to inertial CS $I$ \\ 
$\rotvel{B}{I}{B} = - \rotvel{B}{B}{I}$ & inverse of angular velocity \\
$\rotvel{I}{I}{B} =  \comat{I}{B} \rotvel{B}{I}{B}$  & rotation from $B$ to $I$ \\
$\rotvelhat{I}{I}{B} =  \comat{I}{B} \rotvelhat{B}{I}{B} \comat{I}{B}^\transpose$ & rotation from $B$ to $I$  \\
$\rotvel{D}{A}{D} = \rotvel{D}{A}{B} +  \rotvel{D}{B}{C} + \rotvel{D}{C}{D}$ & composition of angular velocity \\
$\rotvelhat{I}{I}{B} = \drotmat{B}{I} \rotmat{B}{I}^\transpose = \dcomat{I}{B}\comat{I}{B}^\transpose$ & angular velocity of $B$ w.r.t. $I$ expressed in CS $I$  \\
$\rotvelhat{B}{I}{B} = \rotmat{I}{B} \drotmat{I}{B}^\transpose = \comat{I}{B}^\transpose \dcomat{I}{B}$ & angular velocity of $B$ w.r.t. $I$ expressed in CS $B$  \\
$\rotvel{B}{I}{B} = 2 \bar{\vH}(\quat{B}{I}) \dot{\vp}_{B\!I}$  & ang. velocity from time derivative of the rotation quaternion with \\
& $\bar{\vH}(\vp) = \begin{bmatrix}-\imquatvec{p} & -\hat{\imquatvec{p}}+p_0\identity_{3\times 3}\end{bmatrix} \in \mathbb{R}^{3\times4}$  \\
$\dot{\vp}_{B\!I} = \frac{1}{2}\bar{\vH}(\quat{B}{I})^\transpose \rotvel{B}{I}{B}$ & time derivative of the rotation quaternion \\
\end{tabular}

\section{Dynamics of a Multi-Rigid-Body System}

\begin{tabular}{@{}ll@{}}
  $n$			& Number of bodies in system \\
  $n_j$ 		& Number of DoFs of the joints \\
  $n_q$ 		& Number of generalized coordinates \\
  $n_u$ 		& Number of generalized velocities \\
  $\vM$			& Mass matrix \\
  $\vg$			& Gyroscopic and Coriolis forces \\
  $\vf$			& Generalized external forces and torques \\
  $\vh$			& Combined force vector \\
  $\vJ_P$		& Jacobi matrix for translation of point P \\
  $\vJ_{R}$		& Jacobi matrix for rotation \\
  $\vF_Q^A$		& External forces on point Q \\
  $\vM^A$		& External torques \\
%   $\vp$			& Momentum \\
%   $\vN_S$		& Spin at center of gravity \\
  $m$ 			& Mass \\
  $\vTh$ 		& Intertia tensor \\
%   $\vv_P$		& Velocity of point P \\
%   $\va_P$		& Acceleration of point P \\
%   $\vOm$		& Angular velocity \\
%   $\vPs$		& Angular acceleration \\
  $(...)^-$		& Variable before impact \\
  $(...)^+$		& Variable after impact \\
  $(...)^\pm$		& Variable before/after impact \\
  $\mathrm{\Delta} t$	& Time step duration \\
  $\mathrm{\Delta} \vu$	& Velocity change over one time step \\
  $\vW$			& Generalized force directions for contact forces \\
  $\vla$		& Lebesgue-measurable contact forces \\
  $\vLa$		& Purely atomic impact impulses \\
  $\vP$			& Contact percussions \\
\end{tabular}


\subsection{Generalized Coordinates of a Floating-Base System with Rotational Joints}
\begin{tabular}{@{}lll@{}}
$\vq = \begin{pmatrix} \pos{I}{O}{B} \\ \quat{B}{I} \\ \varphi_1 \\ \vdots \\ \varphi_{n_j} \end{pmatrix} \in \mathbb{R}^{7+n_j} = \mathbb{R}^{n_q}$ & 
$\vu = \begin{pmatrix} {}_I \vv_B \\ \rotvel{B}{I}{B} \\ \dot{\varphi}_1 \\ \vdots \\ \dot{\varphi}_{n_j} \end{pmatrix} \in \mathbb{R}^{6+n_j} = \mathbb{R}^{n_u}$  & 
$\dot{\vu} = \begin{pmatrix} {}_I \va_B \\ {}_B\vps_{I\!B} \\ \ddot{\varphi}_1 \\ \vdots \\ \ddot{\varphi}_{n_j} \end{pmatrix} \in \mathbb{R}^{6+n_j}$
\\
\end{tabular}
$\dot{\vq} = \vF \vu, \quad \vF = \begin{pmatrix} \vI_{3\times 3} & \mathbf{0} & \mathbf{0} \\ \mathbf{0} & \frac{1}{2}\bar{\vH}^\mathsf{T} & \mathbf{0} \\ \mathbf{0} & \mathbf{0} & \vI_{n_j\times n_j} \end{pmatrix} \quad \Leftrightarrow \quad \vu = \bar{\vF}\dot{\vq}, \quad \bar{\vF} = \begin{pmatrix} \vI_{3x3} & \mathbf{0} & \mathbf{0} \\ \mathbf{0} & 2\bar{\vH} & \mathbf{0} \\ \mathbf{0} & \mathbf{0} & \vI_{n_j \times n_j} \end{pmatrix}$ \\

\subsection{Equation of Motion with Contacts and no Impulses}
\begin{tabular}{@{}ll@{}}
$\boxed{\vM\dot{\vu} - \vh = \vW\vla}$ with $\vh := \vf - \vg$, and &
$\begin{aligned}\vM &= \sum_{i=1}^n \left[ (\vJ_S^\mathsf{T} m \vJ_S + \vJ_R^\mathsf{T} \vTh_S \vJ_R) \right]_i \\
\vg &= \sum_{i=1}^n \left[ (\vJ_S^\mathsf{T} m \dot{\vJ}_S \vu + \vJ_R^\mathsf{T} (\vTh_S \dot{\vJ}_R \vu + \vOm \times \vTh_S \vOm)) \right]_i \\
\vf &= \sum_{i=1}^n \left[ (\vJ_Q^\mathsf{T} \vF_Q^A + \vJ_R^\mathsf{T} \vM^A) \right]_i \end{aligned}$ \\
\end{tabular}


\subsection{Equation of Motion with Contacts and Impulses}
$\boxed{\vM \mathrm{\Delta} \vu - \vh \mathrm{\Delta} t = \vW \vP}  \quad \left\{
  \begin{array}{r l} \vM (\vu^+ - \vu^-) &= \vW \vLa \\
 \vM \underbrace{(\dot{\vu} \mathrm{d}t + (\vu^+ - \vu^-) \mathrm{d}\eta)}_{\mathrm{d}\vu} - \vh \mathrm{d}t &= \vW \underbrace{(\vla \mathrm{d}t + \vLa \mathrm{d}\eta)}_{\mathrm{d}\vP}\end{array}\right.$ \\



% \subsubsection{Eigen}
% If the quaternion is used to rotate several points (>1) then it is much more efficient to first convert it to a 3x3 Matrix.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  END CONTENT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\rule{0.3\linewidth}{0.25pt}
\scriptsize

Copyright \copyright\ 2013 Autonomous Systems Lab, ETH Zurich

http://asl.ethz.ch


\end{multicols}
\end{document}
